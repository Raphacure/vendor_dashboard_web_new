import{d as O,a as z,bH as V,k as q,u as R,h as H,r as l,j as e,L as J,S as L,P as W,l as G,z as m,bI as K,bJ as Q}from"./index-ChUmNm8R.js";import{S as U}from"./SecoundaryButton-goiA8OO9.js";import{S as X}from"./SucessFullModal-C7pOKWZp.js";import{C as Z}from"./CommonBreadCrumb-ZFUcDUQp.js";import{d as k}from"./dayjs.min-BA1p4t9P.js";import{A as ee}from"./AddressAutoComplete-CKisEBlA.js";import{D as se}from"./index-8lg37tdn.js";import{C as te}from"./calendar-Puy3TPaz.js";import{S as ae}from"./index-D9Bv3C6k.js";import{C as re}from"./chevron-down-u38pTTSM.js";import"./CustomModal-Ds0Ku9jR.js";import"./DownOutlined-z3I3nDv9.js";import"./dropdown-C4zMWtkZ.js";import"./LeftOutlined-lLzXux5-.js";import"./collapse-BbEVqHco.js";import"./index-Ds72tj9v.js";import"./CustomSpinLoader-CrgQ8bNq.js";import"./useIcons-CDf6lDIp.js";import"./CheckOutlined-DPOLd74P.js";import"./index-1XTAFx_Q.js";import"./button-D0Rmo6Y5.js";import"./createLucideIcon-D1dtiQRH.js";const oe=O.div`


    .box-shadow-employee-card{
        box-shadow: 5px 4px 30px 0px #0000001A;
    }

    .ant-select{
        height:54px!important;
    }

    .ant-picker{
        height:54px!important;
    }
`,Te=()=>{var T;const b=z(),Y=V(),{selectedEmployees:x}=Y.state||{},{testId:c}=q(),h=R(),{linkableId:_}=H(),[B,w]=l.useState(!1),[N,P]=l.useState([]),[p,C]=l.useState(null),[j,y]=l.useState(null),[n,E]=l.useState(null),[i,u]=l.useState({}),[S,I]=l.useState(""),[d,f]=l.useState({page:!1,form:!1,timeSlots:!1});console.log("selectedEmployees",x);const D=((T=n==null?void 0:n.price)==null?void 0:T.discounted_price)??0,g=(x==null?void 0:x.length)??0,A=g*D,M=[{name:"HR Dashboard",link:"/dashboard"},{name:"Toxic Substance",link:"/toxic-substance"},{name:`${n==null?void 0:n.service_name}`,link:`/toxic-substance/${c}`},{name:"Booking Form",link:`/toxic-substance/${c}/book`}];l.useEffect(()=>{g===0&&b(`/toxic-substance/${c}`)},[g,b,c]),l.useEffect(()=>{(async()=>{var a,r;try{f(v=>({...v,page:!0}));const s=await h(G({package_id:c}));if(s!=null&&s.error){m.error(((a=s==null?void 0:s.error)==null?void 0:a.message)||"unknown error occured");return}else E((r=s==null?void 0:s.payload)==null?void 0:r.data)}catch{m.error("unknown error occured")}finally{f(o=>({...o,page:!1}))}})()},[h,c]),l.useEffect(()=>{p&&(async()=>{var a,r,o;try{f(v=>({...v,timeSlots:!0}));const s=await h(K({date:k(p).format("YYYY-MM-DD"),vendorId:1}));if(s!=null&&s.error){m.error(((a=s==null?void 0:s.error)==null?void 0:a.message)||"unknown error occured"),P([]),y(null);return}else P(((o=(r=s==null?void 0:s.payload)==null?void 0:r.data)==null?void 0:o.timeslots)??[]),y(null)}catch{m.error("unknown error occured")}finally{f(s=>({...s,timeSlots:!1}))}})()},[p,h]);const F=()=>{let t=!0;const a={};return p||(a.selectedDate="Please select a date",t=!1),j||(a.selectedTimeSlots="Please select a time slot",t=!1),(!S||S.trim()==="")&&(a.address="Please select an address",t=!1),u(a),Object.values(a).forEach(r=>{m.error(r)}),{isValid:t,errors:a}},$=async()=>{var a;const{isValid:t}=F();if(t)try{f(s=>({...s,form:!0}));const r={client_id:_,package_code:c,doctor_id:null,vendor_id:1,selected_date:k(p).format("YYYY-MM-DD"),selected_timeslot:j,users:x==null?void 0:x.map(s=>({user_id:s==null?void 0:s.toString(),vendor_id:1,selected_date:k(p).format("YYYY-MM-DD"),selected_timeslot:j,address:S}))},o=await h(Q(r));if(o!=null&&o.error){m.error(((a=o==null?void 0:o.error)==null?void 0:a.message)||"unknown error occured");return}else m.success("Booking requested successfully"),w(!0)}catch{m.error("unknown error occured")}finally{f(r=>({...r,form:!1}))}};return e.jsxs(oe,{children:[(d==null?void 0:d.page)&&e.jsx(J,{}),e.jsxs("div",{className:"!px-[39px] !py-[48px] bg-white rounded-lg",children:[e.jsx(Z,{className:"!mb-2",items:M}),e.jsx("p",{className:"text-[28px] font-bold text-gray-900 !mb-[40px]",children:n==null?void 0:n.service_name}),e.jsxs("p",{className:"text-[22px] font-medium !mb-[40px]",children:[g," Total Employees selected"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base mb-2",children:"Select Date*"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"w-full h-12 rounded-md pr-10",format:"YYYY-MM-DD",suffixIcon:null,minDate:k(),onChange:t=>{u(t?a=>({...a,selectedDate:""}):a=>({...a,selectedDate:"Please select a date"})),C(t)},value:p}),e.jsx("span",{className:"absolute right-3 top-3 text-indigo-800 pointer-events-none",children:e.jsx(te,{size:20})})]}),e.jsx("span",{className:"text-red-600",children:i==null?void 0:i.selectedDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base mb-2",children:"Select Time*"}),e.jsx("div",{className:"relative",children:e.jsx(L,{spinning:d==null?void 0:d.timeSlots,children:e.jsx(ae,{className:"w-full rounded-md",placeholder:"Select a time slot",suffixIcon:e.jsx(re,{size:20,className:"text-indigo-800"}),options:N==null?void 0:N.map(t=>({value:t==null?void 0:t.slot,label:t==null?void 0:t.slot})),value:j,onChange:t=>{(t==null?void 0:t.length)>0?u(a=>({...a,selectedTimeSlots:""})):u(a=>({...a,selectedTimeSlots:"Please select a time slot"})),y(t)}})})}),e.jsx("span",{className:"text-red-600",children:i==null?void 0:i.selectedTimeSlots})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base mb-2",children:"Enter Site Address*"}),e.jsx(ee,{onAddressSelected:t=>{const a=t==null?void 0:t.formatted_address;I(a),a&&a.trim()!==""?u(r=>({...r,address:""})):u(r=>({...r,address:"Please select an address"}))},placeholder:"Enter your site address",className:"h-[54px]"}),e.jsx("span",{className:"text-red-600",children:i==null?void 0:i.address})]})]}),e.jsxs("div",{className:"flex justify-end !mt-[51.9px] gap-2",children:[e.jsx(U,{onClick:()=>{b(`/toxic-substance/${c}`)},className:"!py-[10px] !px-[20px]",children:"Cancel"}),e.jsx(W,{onClick:$,isLoading:d==null?void 0:d.form,children:"Book Now"})]}),e.jsx("div",{className:"!mt-[76px]  text-center",children:e.jsx("div",{className:"box-shadow-employee-card bg-gray-50 !px-7 !py-8 rounded-[24px] inline-block",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_20px_1fr]  justify-between items-center",children:[e.jsxs("div",{className:"flex items-start flex-col",children:[e.jsx("p",{className:"text-[#252B61] text-[22px] font-medium m-0",children:"Package Selected"}),e.jsxs("p",{className:"text-lg font-medium m-0 text-[22px]",children:[D," × ",g," Employees selected"]})]}),e.jsx("div",{className:"w-[1px] h-[99.4px] bg-[#000000] "}),e.jsxs("div",{className:"flex items-center gap-2 ",children:[e.jsx("p",{className:"text-gray-600 text-[22px] m-0",children:"Total cost"}),e.jsxs("p",{className:"text-4xl font-bold text-[#252B61] m-0",children:["₹",A.toFixed(2)]}),e.jsx("p",{className:"text-[#252B61] text-[22px] m-0 ",children:"Estimated"})]})]})})})]}),e.jsx(X,{open:B,handleClose:()=>w(!1),data:{title:"Test Booking Requested!",message:"Our team will review the availability and logistics, and get back to you with the proposed dates and details shortly.",whatsNext:[e.jsxs("p",{children:[e.jsx("b",{children:"We’re reviewing"})," your request and checking availability."]}),e.jsxs("p",{children:[e.jsx("b",{children:"Our team will contact"})," you for any details needed."]}),e.jsxs("p",{children:[e.jsx("b",{children:"You’ll get a confirmation"})," once it’s scheduled."]})]},handleBack:()=>{b(`/toxic-substance/${c}`)}})]})};export{Te as default};
