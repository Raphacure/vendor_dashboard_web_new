import{r as t,u as A,cX as V,cY as H,z as I,j as e,cL as l,P as B,d as M,c as R,cZ as W,c_ as _,c$ as E}from"./index-ChUmNm8R.js";import{C as w}from"./CustomModal-Ds0Ku9jR.js";import{S as q}from"./SecoundaryButton-goiA8OO9.js";import{C as X}from"./CustomTable-BBwjbMSz.js";import{C as Y}from"./CommonSearchBox-hAv5GAZt.js";import{C as Z}from"./CommonBreadCrumb-ZFUcDUQp.js";import{S as P}from"./index-D9Bv3C6k.js";import"./CustomSpinLoader-CrgQ8bNq.js";import"./CustomPagination-BfzEq6pA.js";import"./index-gapj9Wcb.js";import"./chevron-down-u38pTTSM.js";import"./createLucideIcon-D1dtiQRH.js";import"./Table-BhIN-nUr.js";import"./styleChecker-DD0Z1krI.js";import"./DownOutlined-z3I3nDv9.js";import"./addEventListener-D7w6vIGx.js";import"./useBubbleLock-BnnxIxI9.js";import"./button-D0Rmo6Y5.js";import"./LeftOutlined-lLzXux5-.js";import"./CheckOutlined-DPOLd74P.js";import"./dropdown-C4zMWtkZ.js";import"./collapse-BbEVqHco.js";import"./index-De2sQM66.js";import"./useForm-CIMDi_Qk.js";import"./Input-ClusE8wk.js";import"./useForceUpdate-jQjUdsvY.js";import"./useIcons-CDf6lDIp.js";import"./index-1XTAFx_Q.js";import"./Pagination-BbDnNTXA.js";import"./extendsObject-78o_rR5W.js";const J=({isEdit:i,onHide:g,onSuccess:v,defaultData:C,selectedId:h})=>{const[c,b]=t.useState(C??{subject:"",description:"",status:""}),[u,m]=t.useState({}),f=A(),r=t.useCallback((n,a)=>{switch(n){case"subject":if(!a.trim())return"Title is required";if(a.length<3)return"Title must be at least 3 characters";break}},[]);console.log(u,"errors");const T=t.useCallback(async()=>{var p,d;const n={};if(Object.entries(c).forEach(([x,N])=>{const S=r(x,N??"");S&&(n[x]=S)}),m(n),Object.keys(n).length!==0)return;console.log("Form submitted:",c);let a=null;i?a=await f(V({id:h,body:c})):a=await f(H({...c,status:"open"})),(p=a==null?void 0:a.payload)!=null&&p.success?(I.success(`Ticket ${i?"updated":"created"} successfully!.`),v()):I.error(((d=a==null?void 0:a.error)==null?void 0:d.message)||"Something went wrong!.")},[c,r,i,h]),o=t.useCallback(n=>{const{name:a,value:p}=n.target;m(d=>({...d,[a]:r(a,p)})),b(d=>({...d,[a]:p}))},[]);return e.jsxs(w,{open:!0,handleClose:g,title:`${i?"Edit":"Create"} Ticket`,children:[e.jsx(w.Body,{children:e.jsxs(l,{noValidate:!0,children:[e.jsxs(l.Group,{controlId:"formTitle",className:"mb-3",children:[e.jsx(l.Label,{children:"Title"}),e.jsx(l.Control,{type:"text",placeholder:"Enter title",name:"subject",value:c.subject,onChange:o,isInvalid:!!u.subject}),e.jsx(l.Control.Feedback,{type:"invalid",children:u.subject})]}),e.jsxs(l.Group,{controlId:"formDescription",className:"mb-3",children:[e.jsx(l.Label,{children:"Description"}),e.jsx(l.Control,{as:"textarea",rows:3,placeholder:"Enter description",name:"description",value:c.description,onChange:o,isInvalid:!!u.description}),e.jsx(l.Control.Feedback,{type:"invalid",children:u.description})]})]})}),e.jsx(w.Footer,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(q,{onClick:g,children:"Cancel"}),e.jsx(B,{className:"!bg-[#252b61] border-0 !border-transparent !text-white",type:"button",onClick:T,children:"Submit"})]})})]})},K=M.div`

`,Ie=()=>{const{error:i,loading:g,tickets:v,totalTickets:C}=R(s=>s==null?void 0:s.ticket),[h,c]=t.useState(20),[b,u]=t.useState(1),[m,f]=t.useState(""),[r,T]=t.useState({label:"All",value:"all"}),[o,n]=t.useState({label:"All",value:"all"}),a=[{label:"All",value:"all"},{label:"In Progress",value:"in-progress"},{label:"Open",value:"open"},{label:"Closed",value:"closed"}],p=[{label:"All",value:"all"},{label:"Email",value:"email"},{label:"Call",value:"call"}],[d,x]=t.useState(!1),[N,S]=t.useState(null),[F,D]=t.useState(null),L=A();t.useEffect(()=>{i&&I.error(i)},[i]);const O=(s,j)=>{c(s),u(j)},k=t.useCallback(()=>{const s={page:b,count:h};m&&(s.search_text=m),(r==null?void 0:r.value)!=="all"&&(s.status=r==null?void 0:r.value),(o==null?void 0:o.value)!=="all"&&(s.channel=o==null?void 0:o.value),L(W(s))},[h,b,m,r,o]);t.useEffect(()=>{const s=setTimeout(()=>{k()},300);return()=>{clearTimeout(s)}},[k]);const y=t.useCallback(()=>{x(!1),S(null),D(null)},[]),$=t.useCallback(()=>{y(),k()},[y,k]),z=s=>{const j="text-white p-2 rounded-sm";switch(s){case"open":return e.jsx("span",{className:`bg-green-500 ${j}`,children:"Open"});case"closed":return e.jsx("span",{className:`bg-red-500 ${j}`,children:"Closed"});case"in-progress":return e.jsx("span",{className:`bg-yellow-500 ${j}`,children:"In Progress"});default:return e.jsx(e.Fragment,{children:"N/A"})}},G=[{label:"Id",key:"id",dataIndex:"id"},{label:"Subject",key:"subject",dataIndex:"subject"},{label:"Status",key:"status",render:s=>z(s==null?void 0:s.status)}];return e.jsx(K,{children:e.jsxs("div",{className:"freshbag-wrapper p-3",children:[e.jsx(Z,{items:[{name:"Home",link:"/"},{name:"Tickets",link:"/tickets"}]}),e.jsxs("h1",{children:["Tickets (",C??0,")"]}),e.jsx("div",{className:"d-flex align-items-center mb-2",children:e.jsx(Y,{onSearch:s=>{f(s)},placeHolder:"Search for ticket",searchText:m})}),e.jsxs(_,{className:"mb-3 items-end",children:[e.jsx(E,{md:9,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(l.Group,{className:"delta-signup-md",controlId:"email",children:[e.jsx(l.Label,{className:"text-sm mb-0",children:" Status"}),e.jsx(P,{allowClear:!0,labelInValue:!0,value:r,placeholder:"Select Status",onChange:s=>T(s),options:a,className:"delta-select select-filter",style:{minWidth:150}})]}),e.jsxs(l.Group,{className:"delta-signup-md",controlId:"email",children:[e.jsx(l.Label,{className:"text-sm mb-0",children:" Channel"}),e.jsx(P,{allowClear:!0,labelInValue:!0,value:o,placeholder:"Select Channel",onChange:s=>n(s),options:p,className:"delta-select select-filter",style:{minWidth:150}})]})]})}),e.jsx(E,{md:3,children:e.jsx("div",{className:" flex justify-end",children:e.jsx(B,{onClick:()=>{x(!0)},className:"py-2",children:"Create Ticket"})})})]}),e.jsx("div",{children:e.jsx(X,{data:v,columns:G,showingName:"Tickets",isLoading:g,onPageChange:O,page:b,pageSize:h,total:C,pagination:!0})}),d?e.jsx(J,{onHide:y,onSuccess:$,isEdit:!!F,selectedId:F,defaultData:N}):e.jsx(e.Fragment,{})]})})};export{Ie as default};
