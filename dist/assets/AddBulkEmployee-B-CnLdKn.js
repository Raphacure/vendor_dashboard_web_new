import{d as P,u as I,a as R,h as T,r as h,ck as U,j as e,P as q,z as x,bM as L}from"./index-ChUmNm8R.js";import{r as z,u as $}from"./xlsx-BUW7exb-.js";import{F as M,D as G,I as H}from"./DownloadCsv-Cwn0aB6k.js";import{C as O}from"./CommonBreadCrumb-ZFUcDUQp.js";import"./createLucideIcon-D1dtiQRH.js";import"./index-HwAQ7eJ8.js";import"./DownOutlined-z3I3nDv9.js";import"./dropdown-C4zMWtkZ.js";import"./LeftOutlined-lLzXux5-.js";import"./collapse-BbEVqHco.js";const V=P.div`
  width: 100%;
  padding:39px 37px;
  font-family: inter;

  @media (max-width: 675px) {
    padding: 15px;
  }
`,le=()=>{const b=I(),k=R(),{linkableId:v}=T(),[t,y]=h.useState([]),[n,d]=h.useState([]),[o,f]=h.useState({booking:!1,page:!1,csv:!1}),[E]=U(),A=E.get("from"),_=[{name:"HR Dashboard",link:"/dashboard"},{name:"Toxic Substances",link:"/toxic-substance"}];function S(s){if(s){const l=new FileReader;l.readAsArrayBuffer(s),l.onload=a=>{var u;const i=(u=a.target)==null?void 0:u.result;if(i){const g=z(i,{type:"binary"}),F=g.SheetNames[0],C=g.Sheets[F],j=$.sheet_to_json(C,{raw:!1});console.log("json",j);const N=["first_name","last_name","email","employee_id","phone","age","gender","designation","address","dob"],r=j.map(p=>({...p,relation:"Self"})).filter((p,D)=>N.every(c=>{const m=p[c]!==void 0&&p[c]!==null&&p[c]!=="";return m||x.error(`Row ${D+2}: Missing required field '${c}'. Please ensure all mandatory fields are present.`),m})?N.reduce((c,m)=>(c[m]=p[m],c),{}):!1);r.length>0?(y(r),d([...Array(r==null?void 0:r.length).keys()]),x.success(`${r.length} employees added successfully`)):(y([]),d([]),x.error("No valid employee data found after filtering."))}}}}console.log("employeeList",t),console.log("selectedEmployees",n);const B=async()=>{var l;const s={users:t.filter((a,i)=>n.includes(i)),client_id:v};try{f(i=>({...i,booking:!0})),console.log("payload",s);const a=await b(L(s));if(a!=null&&a.error){x.error(((l=a==null?void 0:a.error)==null?void 0:l.message)||"unknown error occured");return}x.success("Employees added successfully"),k(A||-1)}catch{x.error("Something went wrong")}finally{f(a=>({...a,booking:!1}))}};return e.jsxs(V,{children:[e.jsx(O,{className:"mb-2",items:_}),e.jsx("p",{className:"text-[28px] font-semibold font-[Inter] !mb-[23.87px]",children:"Bulk Upload/Employee List"}),e.jsx("p",{className:"text-[22px] font-medium !mb-[58.32px]",children:"Please Upload Excel"}),e.jsxs("div",{className:"w-full flex flex-col gap-6",children:[e.jsxs("div",{className:"grid grid-col-1 gap-y-2 sm:grid-cols-[1.2fr_2px_1fr] gap-x-10",children:[e.jsx("div",{className:"flex-1",children:e.jsx(M,{onFileUpload:S,acceptType:".csv",mode:"single",acceptText:"csv"})}),e.jsx("span",{className:"w-full min-h-[2px] sm:w-[2px] bg-slate-200 self-stretch"}),e.jsxs("div",{className:"flex flex-col items-start gap-[22px]",children:[e.jsxs("span",{className:"text-[16px] text-black font-medium",children:["Download The"," ","Template For Bulk Upload"]}),e.jsxs("div",{children:[e.jsxs("a",{href:"#",className:"w-full flex items-center !no-underline gap-2 border !border-[#aeaeae] rounded-lg !px-[7.98px] !py-[16.02px] transition-colors",children:[e.jsx("img",{className:"w-[40px] h-[40px]",src:"https://raphacure-public-images.s3.ap-south-1.amazonaws.com/119535-1746609861744.png",alt:"xls lgo"}),e.jsx(G,{csvData:[["first_name","last_name","email","employee_id","phone","age","gender","designation","address","dob"]],children:e.jsx("span",{className:"text-[14px] font-medium !text-[#252b61]",children:"Template.2025.csv"})})]}),e.jsxs("div",{className:"flex gap-[13.7px] !mt-[11.17px]",children:[e.jsx(H,{className:"w-[14px] h-[14px] flex-shrink-0 mt-1",color:"#888"}),e.jsx("span",{className:"text-[14px] text-[#888]",children:"only the csv file types are allowed. Please download the above templet fill & upload for extra feilds contact admin"})]})]})]})]}),e.jsx("hr",{className:"my-2 border-gray-200"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium text-[22px]",children:[t==null?void 0:t.length," Employees Added"]}),e.jsx(q,{isLoading:o==null?void 0:o.booking,onClick:B,className:"!py-[10px] !px-[20px]",children:"Add Bulk Employees"})]}),e.jsx("div",{className:"overflow-x-auto rounded-[20px] border border-gray-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-sm ",children:[e.jsx("thead",{className:"bg-blue-50 text-[16px] !border-[4px] border-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:e.jsx("input",{className:"scale-[1.65]",type:"checkbox",checked:n.length===t.length&&n.length>0,onChange:()=>{n.length===t.length?d([]):d([...Array(t.length).keys()])}})}),e.jsx("th",{className:"px-3 py-2 text-left",children:"First Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Last Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Email"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Employee ID"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Phone"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Age"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Gender"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Designation"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Address"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"DOB"})]})}),e.jsx("tbody",{className:"text-[18px]",children:t.length===0?e.jsx("tr",{className:"border-t border-gray-100 transition-colors",children:e.jsx("td",{colSpan:8,className:"px-3 py-4 text-center text-gray-500",children:"No employees added"})}):t.map((s,l)=>e.jsxs("tr",{className:"border-t border-gray-100 transition-colors",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{className:"scale-[1.65]",type:"checkbox",checked:n.includes(l),onChange:()=>{n.includes(l)?d(n.filter(a=>a!==l)):d([...n,l])}})}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.first_name}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.last_name}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.email}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.employee_id}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.phone}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.age}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.gender}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.designation}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.address}),e.jsx("td",{className:"px-3 py-2",children:s==null?void 0:s.dob})]},l))})]})})]})]})};export{le as default};
