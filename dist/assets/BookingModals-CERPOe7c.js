import{d as V,u as C,aJ as k,r as H,j as e,P as B,c6 as K,bI as Q,z as N,dg as W,de as U,cn as Y}from"./index-ChUmNm8R.js";import{S as M}from"./SecoundaryButton-goiA8OO9.js";import{B as X}from"./BookingDetailsModal-HSRnt7fr.js";import{C as Z}from"./Accordium-D_-yQ0k_.js";import{d as m}from"./dayjs.min-BA1p4t9P.js";import{C as J}from"./CustomSpinLoader-CrgQ8bNq.js";import{C as b}from"./CustomModal-Ds0Ku9jR.js";import{D}from"./index-8lg37tdn.js";const ee=V.div`

    .reject-modal-body p{
        margin:20px 10px
    }   
    .reject-modal-footer{
        padding:10px;
        display:flex;
        justify-content: center;
        gap:10px;
    }

`,se=V.div`
  .time-slot-div {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-top: 10px;

    .active {
      background-color: #1d2a5b;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
  }

  .time-slot {
    border-radius: 8px;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    padding: 12px 14px;
    font-family: Inter, system-ui, sans-serif;
    font-weight: 500;
    font-size: 14px;
    line-height: 100%;
    text-align: center;
    color: #252B61;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid transparent;
    
    &:hover {
      border-color: #1d2a5b;
      background-color: #f8fafc;
      transform: translateY(-1px);
    }
  }
`,ne=({data:s,handleClose:i,handleSoftClose:g})=>{var O,P,R,F,T,$,I,S,z,L;const y=C(),[n,h]=k.useState({collection_1_date:m()}),[t,j]=k.useState({}),[l,p]=k.useState([]),[v,A]=k.useState(!1),q=d=>{console.log("date",d),h(o=>({...o,collection_1_date:d?d.format("YYYY-MM-DD"):null}))};H.useEffect(()=>{(async o=>{var x,r,a,_;try{A(!0);const u=["virtual_consultation","opd_consultation"].includes(o)&&(s==null?void 0:s.virtual_type)!=="instant",c=await y(u?K({id:(x=s==null?void 0:s.doctor)==null?void 0:x.id,type:(s==null?void 0:s.virtual_type)??"opd",date:m(n==null?void 0:n.collection_1_date).format("YYYY-MM-DD")}):Q({date:m(n==null?void 0:n.collection_1_date).format("YYYY-MM-DD"),vendorId:1}));if(c!=null&&c.error){N.error(((r=c==null?void 0:c.error)==null?void 0:r.message)||"Unknown Error Occurred");return}p(u?c==null?void 0:c.payload:(_=(a=c==null?void 0:c.payload)==null?void 0:a.data)==null?void 0:_.timeslots)}catch(u){N.error("Unknown error occurred"),console.error(u)}finally{A(!1)}})(s==null?void 0:s.type)},[n,y,(O=s==null?void 0:s.doctor)==null?void 0:O.id,s==null?void 0:s.virtual_type,s==null?void 0:s.type]);const E=async()=>{var x;let d={};if(m(n==null?void 0:n.collection_1_date).format("DD/MM/YYYY")===m(s==null?void 0:s.collection_1_date,"DD/MM/YYYY").format("DD/MM/YYYY")&&(n==null?void 0:n.collection_1_slot)===(s==null?void 0:s.collection_1_slot)){N.error("Rescheduled date and time cannot be the same as original booking");return}if(n!=null&&n.collection_1_slot||(d={...d,collection_1_slot:"Please select a time slot"},j(r=>({...r,collection_1_slot:"Please select a time slot"}))),n!=null&&n.collection_1_date||(d={...d,collection_1_date:"Please select a date"},j(r=>({...r,collection_1_date:"Please select a date"}))),Object.keys(d).length>0){N.error("Please select a valid date and time slot");return}j({});const o={bookingid:s==null?void 0:s.id,payload:{booking:n}};try{const r=await y(W(o));if(r!=null&&r.error){N.error(((x=r==null?void 0:r.error)==null?void 0:x.message)||"Unknown Error Occured");return}r!=null&&r.payload&&(N.success("Booking rescheduled successfully"),h({}),i())}catch{N.error("unknown error occured")}};if((s==null?void 0:s.virtual_type)==="instant")return null;const G=[...["virtual_consultation","opd_consultation"].includes(s==null?void 0:s.type)?[{title:`Morning (${((F=(R=(P=l==null?void 0:l[0])==null?void 0:P.timeslots)==null?void 0:R.morning)==null?void 0:F.length)??0} slots)`,render:d=>{var o,x,r,a,_,u;return((r=(x=(o=l==null?void 0:l[0])==null?void 0:o.timeslots)==null?void 0:x.morning)==null?void 0:r.length)===0?e.jsx("div",{children:e.jsx("p",{children:"No time slots availabe"})}):e.jsx("div",{className:"time-slot-div",children:(u=(_=(a=l==null?void 0:l[0])==null?void 0:a.timeslots)==null?void 0:_.morning)==null?void 0:u.map(c=>e.jsx("span",{onClick:()=>h(f=>({...f,collection_1_slot:c})),className:`time-slot ${(n==null?void 0:n.collection_1_slot)===c?"active":""}`,children:c},c))})}},{title:`Afternoon (${((I=($=(T=l==null?void 0:l[0])==null?void 0:T.timeslots)==null?void 0:$.afternoon)==null?void 0:I.length)??0} slots)`,render:d=>{var o,x,r,a,_,u;return((r=(x=(o=l==null?void 0:l[0])==null?void 0:o.timeslots)==null?void 0:x.afternoon)==null?void 0:r.length)===0?e.jsx("div",{children:e.jsx("p",{children:"No time slots availabe"})}):e.jsx("div",{className:"time-slot-div",children:(u=(_=(a=l==null?void 0:l[0])==null?void 0:a.timeslots)==null?void 0:_.afternoon)==null?void 0:u.map(c=>e.jsx("span",{onClick:()=>h(f=>({...f,collection_1_slot:c})),className:`time-slot ${(n==null?void 0:n.collection_1_slot)===c?"active":""}`,children:c},c))})}},{title:`Evening (${((L=(z=(S=l==null?void 0:l[0])==null?void 0:S.timeslots)==null?void 0:z.evening)==null?void 0:L.length)??0} slots)`,render:d=>{var o,x,r,a,_,u;return((r=(x=(o=l==null?void 0:l[0])==null?void 0:o.timeslots)==null?void 0:x.evening)==null?void 0:r.length)===0?e.jsx("div",{children:e.jsx("p",{children:"No time slots availabe"})}):e.jsx("div",{className:"time-slot-div",children:(u=(_=(a=l==null?void 0:l[0])==null?void 0:a.timeslots)==null?void 0:_.evening)==null?void 0:u.map(c=>e.jsx("span",{onClick:()=>h(f=>({...f,collection_1_slot:c})),className:`time-slot ${(n==null?void 0:n.collection_1_slot)===c?"active":""}`,children:c},c))})}}]:[{title:`Select Time Slot (${(l==null?void 0:l.length)??0} slots)`,render:d=>(l==null?void 0:l.length)===0?e.jsx("div",{children:e.jsx("p",{children:"No time slots availabe"})}):e.jsx("div",{className:"time-slot-div",children:l==null?void 0:l.map(o=>e.jsx("span",{onClick:()=>h(x=>({...x,collection_1_slot:o==null?void 0:o.slot})),className:`time-slot ${(n==null?void 0:n.collection_1_slot)===(o==null?void 0:o.slot)?"active":""}`,children:o==null?void 0:o.slot},o==null?void 0:o.slot))})}]];return e.jsxs(e.Fragment,{children:[e.jsx(b.Body,{children:e.jsx(se,{children:e.jsxs("div",{className:"flex gap-5 pt-6 px-6 !pb-24 lg:!pb-32 min-h-[450px] flex-col lg:flex-row bg-gray-50 rounded-lg p-2",children:[e.jsxs("div",{className:"basis-1/2 bg-white p-5 rounded-xl shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Reschedule Booking"}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select New Date"}),e.jsx(D,{value:n!=null&&n.collection_1_date?m(n==null?void 0:n.collection_1_date):null,onChange:q,format:"YYYY-MM-DD",className:"w-full rounded-lg border-[1px] border-gray-300 hover:border-blue-500 focus:border-blue-500 shadow-sm py-2 px-3 transition-colors duration-200",style:{height:"42px"},allowClear:!0,placeholder:"Pick a date",disabledDate:d=>d&&d<m().startOf("day")}),(t==null?void 0:t.collection_1_date)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t==null?void 0:t.collection_1_date})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 mt-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-3 border-b border-blue-100 pb-2",children:"Booking Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Booking ID:"}),e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.id)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Previous Date:"}),e.jsx("span",{className:"font-medium",children:s!=null&&s.collection_1_date?String(s==null?void 0:s.collection_1_date):"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Previous Time:"}),e.jsx("span",{className:"font-medium",children:s!=null&&s.collection_1_slot?String(s==null?void 0:s.collection_1_slot):"N/A"})]}),e.jsxs("div",{className:"flex justify-between bg-green-50 p-2 rounded-md mt-3 mb-1",children:[e.jsx("span",{className:"text-gray-700",children:"Rescheduled Date:"}),e.jsx("span",{className:"font-medium text-green-700",children:n!=null&&n.collection_1_date?m(n==null?void 0:n.collection_1_date).format("DD/MM/YYYY"):"N/A"})]}),e.jsxs("div",{className:"flex justify-between bg-green-50 p-2 rounded-md",children:[e.jsx("span",{className:"text-gray-700",children:"Rescheduled Time:"}),e.jsx("span",{className:"font-medium text-green-700",children:n!=null&&n.collection_1_slot?String(n==null?void 0:n.collection_1_slot):"N/A"})]})]})]})]}),e.jsx(J,{spinning:v,children:e.jsxs("div",{className:"basis-1/2 bg-white p-5 rounded-xl shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Select a Time Slot"}),e.jsx(Z,{data:G}),(t==null?void 0:t.collection_1_slot)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t==null?void 0:t.collection_1_slot})]})})]})})}),e.jsx(b.Footer,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{onClick:()=>g(),children:"Cancel"}),e.jsx(B,{onClick:E,children:"Reschedule"})]})})]})},w=[{type:"reject",Component({selectedAction:s,modalData:i,handleClose:g,handleOpen:y,handleSoftClose:n}){const h=C(),t=async()=>{var v;const j={id:i==null?void 0:i.id,bookingObj:{status:"cancelled"}},l=await h(U(j)),p=JSON.parse(JSON.stringify(l));if(p!=null&&p.error){Y.error(((v=p==null?void 0:p.error)==null?void 0:v.message)??"unknown error occured");return}else Y.success("Status updated successfully"),g()};return e.jsx(e.Fragment,{children:e.jsxs(b,{handleClose:g,open:!0,title:"Reject Booking",children:[e.jsx(b.Body,{children:e.jsx("div",{className:"reject-modal-body",children:e.jsxs("p",{children:["Are you sure you want to reject the booking ",i==null?void 0:i.id]})})}),e.jsx(b.Footer,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{onClick:n,children:"cancel"}),e.jsx(B,{onClick:t,children:"Reject"})]})})]})})}},{type:"approve",Component({selectedAction:s,modalData:i,handleClose:g,handleOpen:y,handleSoftClose:n}){const h=C(),t=async()=>{var v;const j={id:i==null?void 0:i.id,bookingObj:{status:"booking_scheduled"}},l=await h(U(j)),p=JSON.parse(JSON.stringify(l));if(p!=null&&p.error){Y.error(((v=p==null?void 0:p.error)==null?void 0:v.message)??"unknown error occured");return}else Y.success("Status updated successfully"),g()};return e.jsx(e.Fragment,{children:e.jsxs(b,{handleClose:g,open:!0,title:"Approve Booking",children:[e.jsx(b.Body,{children:e.jsx("div",{className:"reject-modal-body",children:e.jsxs("p",{children:["Are you sure you want to Approve the booking ",i==null?void 0:i.id]})})}),e.jsx(b.Footer,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{onClick:n,children:"cancel"}),e.jsx(B,{onClick:t,children:"Approve"})]})})]})})}},{type:"reschedule",Component({selectedAction:s,modalData:i,handleClose:g,handleOpen:y,handleSoftClose:n}){return e.jsx(e.Fragment,{children:e.jsx(b,{handleClose:n,open:!0,title:"Reshedule Booking",children:e.jsx(ne,{handleSoftClose:n,handleClose:g,data:i})})})}},{type:"booking_details",Component(s){return e.jsx(X,{...s})}}],pe=({selectedAction:s,modalData:i,handleClose:g,handleOpen:y,open:n,handleSoftClose:h})=>{const t=w==null?void 0:w.find(j=>(j==null?void 0:j.type)===s);return e.jsx(e.Fragment,{children:e.jsx(ee,{children:n&&t&&e.jsx(t.Component,{selectedAction:s,modalData:i,handleClose:g,handleOpen:y,handleSoftClose:h})})})};export{pe as B};
