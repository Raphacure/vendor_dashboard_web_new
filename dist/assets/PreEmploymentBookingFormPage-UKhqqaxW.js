import{d as G,k as J,a as X,bH as T,u as L,h as ee,r as c,z as d,j as e,L as se,P as te,i as ae,bI as le,bK as re}from"./index-ChUmNm8R.js";import{S as ne}from"./SecoundaryButton-goiA8OO9.js";import{S as ce}from"./SucessFullModal-C7pOKWZp.js";import{C as oe}from"./CommonBreadCrumb-ZFUcDUQp.js";import{d as w}from"./dayjs.min-BA1p4t9P.js";import{C as S}from"./CustomSpinLoader-CrgQ8bNq.js";import{p as ie}from"./packages.constants-DLMx6o0r.js";import{S as C}from"./index-D9Bv3C6k.js";import{C as B}from"./chevron-down-u38pTTSM.js";import{D as de}from"./index-8lg37tdn.js";import{C as me}from"./calendar-Puy3TPaz.js";import{C as ue}from"./clock-DONahVyX.js";import"./CustomModal-Ds0Ku9jR.js";import"./DownOutlined-z3I3nDv9.js";import"./dropdown-C4zMWtkZ.js";import"./LeftOutlined-lLzXux5-.js";import"./collapse-BbEVqHco.js";import"./useIcons-CDf6lDIp.js";import"./CheckOutlined-DPOLd74P.js";import"./createLucideIcon-D1dtiQRH.js";import"./index-1XTAFx_Q.js";import"./button-D0Rmo6Y5.js";const pe=G.div`
  .box-shadow-employee-card {
    box-shadow: 5px 4px 30px 0px #0000001a;
  }

  .ant-picker {
    height: 54px !important;
    border-radius: 10px;
  }

  .ant-select {
    height: 54px !important;
  }

  .ant-select-selector{
    border-radius: 10px;
  }
`,xe={id:1,name:"Raphacure Preferred Vendor",phone:"95551 66000",address:"We will select the nearest vendor for you!",city:"Nearby",zip:560102,slot_start_time:"07:00:00",slot_end_time:"19:00:00",week_off_days:"0",type:"pathology_lab",parent_id:null,mapped_pin_codes:"500075,500034,",image:"https://raphacure-public-images.s3.ap-south-1.amazonaws.com/wa-default.png",rating:null,status:"requested",old_users_data:null,created_at:null,updated_at:"2025-04-25T05:18:27.456Z",state:"karnataka",search_keys:"Raphacure Preferred Vendor",instant_pin_codes:null,facilities:[],services:[],default_consultation_cost:0,available_in_90:!1,collection_type:"center",address1:null,address2:null,latitude:null,longitude:null,primary_email:"wellness@raphacure.com",secondary_email:null,created_by:null,spoc_contact_first_name:null,spoc_contact_last_name:null,spoc_contact_phone_no:null,spoc_contact_email:null,spoc_contact_office_no:null,spoc_contact_designation:null,marketplace_name:"raphacure",gst_number:null,secondary_phone:null,registration_details:null,vendor_client_id:null,is_premium:!1,country_code:null,price:{actual_cost:1200,discount_percentage:0,service_charges:0,discounted_price:1200}},Oe=()=>{var Y,I,z;const{type:M}=J(),m=X(),O=T(),x=L(),{linkableId:g}=ee(),{selectedEmployees:j}=O.state||{},[$,F]=c.useState(!1),t=ie.find(s=>s.type===M);t||m(-1);const R=[{name:"Quick Links",link:"/quick-links"},{name:`${t==null?void 0:t.name}`,link:`/package/${t==null?void 0:t.type}`},{name:`${t==null?void 0:t.name} Booking`,link:`/package/${t==null?void 0:t.type}/book`}],[r,u]=c.useState({page:!1,timeSlots:!1,form:!1,package:!1}),[p,q]=c.useState(null),[v,y]=c.useState(null),[D,P]=c.useState([]),[N,A]=c.useState(null),[n,U]=c.useState(null),[b,h]=c.useState({}),[V,W]=c.useState([]),o=V.find(s=>s.service_code===(n==null?void 0:n.service_code));console.log("selectedPackageDetails",o);const f=(j==null?void 0:j.length)??0,E=((Y=o==null?void 0:o.price)==null?void 0:Y.discounted_price)??0,H=f*E;c.useEffect(()=>{f===0&&(d.error("Please select at least 1 employee"),m(`/package/${t==null?void 0:t.type}}`))},[f,m,t]),c.useEffect(()=>{(async()=>{var a,i,_;try{u(k=>({...k,package:!0}));const l=await x(ae({filters:{count:200,clientId:g,categoryIds:(t==null?void 0:t.category)??[]}}));if(l!=null&&l.error){d.error(((a=l==null?void 0:l.error)==null?void 0:a.message)||"unknown error occured");return}W(((_=(i=l==null?void 0:l.payload)==null?void 0:i.data)==null?void 0:_.data)||[])}catch{d.error("Failed to fetch packages")}finally{u(l=>({...l,package:!1}))}})()},[x,g]),c.useEffect(()=>{p&&(async()=>{var a,i,_;try{u(k=>({...k,timeSlots:!0}));const l=await x(le({date:w(p).format("YYYY-MM-DD"),vendorId:1}));if(l!=null&&l.error){d.error(((a=l==null?void 0:l.error)==null?void 0:a.message)||"unknown error occured"),P([]),y(null);return}else P(((_=(i=l==null?void 0:l.payload)==null?void 0:i.data)==null?void 0:_.timeslots)??[]),y(null)}catch{d.error("unknown error occured")}finally{u(l=>({...l,timeSlots:!1}))}})()},[p,x]);const K=()=>{let s=!0;const a={};return p||(a.selectedDate="Please select a date",s=!1),v||(a.selectedTime="Please select a time",s=!1),N||(a.selectedVendors="Please select a vendor",s=!1),n||(a.selectedPackage="Please select a package",s=!1),h(a),Object.values(a).forEach(i=>{d.error(i)}),{isValid:s,errors:a}},Q=async()=>{if(!K().isValid)return;const s={client_id:g,package_code:o==null?void 0:o.service_code,doctor_id:null,vendor_id:Number(N??1),selected_date:w(p).format("YYYY-MM-DD"),selected_timeslot:v,users:j};u(a=>({...a,isBooking:!0}));try{if(s){const a=await x(re(s));if(a.error){d.error(a.error.message||"Unknown error occurred");return}else d.success("Order Booked Successfully!"),m("/package/pre-employment")}}catch{d.error("Unknown error occurred")}finally{u(a=>({...a,isBooking:!1}))}},Z=()=>{m(-1)};return console.log("timeSlots",D),e.jsxs(pe,{children:[(r==null?void 0:r.page)&&e.jsx(se,{}),e.jsxs("div",{className:"!px-[39px] !py-[48.06px] bg-white rounded-lg",children:[e.jsx(oe,{className:"mb-2",items:R}),e.jsx("p",{className:"text-[28px] font-bold text-gray-900 !mb-[40.4px]",children:t==null?void 0:t.name}),e.jsxs("p",{className:"text-[22px] font-medium !mb-[39.68px]",children:[f," Total Employees selected"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-x-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base mb-2",children:"Select Package*"}),e.jsx("div",{className:"relative",children:e.jsx(S,{spinning:r==null?void 0:r.package,children:e.jsx(C,{className:"w-full h-12 rounded-md",placeholder:"Select a package",suffixIcon:e.jsx(B,{size:20,className:"text-indigo-800"}),value:n==null?void 0:n.service_code,onChange:(s,a)=>{U(a.packageDetails),h(i=>({...i,selectedPackage:""}))},options:V.map(s=>({label:s.service_name,value:s.service_code,packageDetails:s})),disabled:r==null?void 0:r.page})})}),e.jsx("span",{className:"text-red-600",children:b.selectedPackage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base mb-2",children:"Select Vendor*"}),e.jsx("div",{className:"relative",children:e.jsx(S,{spinning:r==null?void 0:r.package,children:e.jsx(C,{className:"w-full h-12 rounded-md",placeholder:"Select a Vendor",suffixIcon:e.jsx(B,{size:20,className:"text-indigo-800"}),value:N,onChange:s=>{A(s),h(a=>({...a,selectedVendors:""}))},options:(z=((I=n==null?void 0:n.vendors)==null?void 0:I.length)>0?n==null?void 0:n.vendors:[xe])==null?void 0:z.map(s=>({label:s==null?void 0:s.name,value:s==null?void 0:s.id})),disabled:(r==null?void 0:r.page)||!(n!=null&&n.service_code)})})}),e.jsx("span",{className:"text-red-600",children:b.selectedVendors})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base mb-2",children:"Select Date*"}),e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"w-full h-12 rounded-md pr-10",format:"YYYY-MM-DD",minDate:w(),suffixIcon:null,value:p,onChange:s=>{q(s),h(a=>({...a,selectedDate:""}))}}),e.jsx("span",{className:"absolute right-3 top-3 text-indigo-800 pointer-events-none",children:e.jsx(me,{size:20})})]}),e.jsx("span",{className:"text-red-600",children:b.selectedDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base mb-2",children:"Select Time*"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{spinning:r==null?void 0:r.timeSlots,children:e.jsx(C,{className:"w-full h-12 rounded-md",placeholder:"Select a time",suffixIcon:e.jsx(B,{size:20,className:"text-indigo-800"}),value:v,onChange:s=>{y(s),h(a=>({...a,selectedTime:""}))},options:D.map(s=>({label:s==null?void 0:s.slot,value:s==null?void 0:s.slot})),disabled:r==null?void 0:r.timeSlots})}),e.jsx("span",{className:"absolute right-3 top-3 text-indigo-800 pointer-events-none",children:e.jsx(ue,{size:20})})]}),e.jsx("span",{className:"text-red-600",children:b.selectedTime})]})]}),e.jsxs("div",{className:"flex justify-end gap-[21px] !mt-[47.7px]",children:[e.jsx(ne,{className:"!px-[20px] !py-[10px]",onClick:Z,children:"Cancel"}),e.jsx(te,{type:"submit",className:"!px-[20px] !py-[10px]",isLoading:r==null?void 0:r.form,onClick:Q,children:"Book Now"})]}),e.jsx("div",{className:"!mt-[76.95px]  text-center",children:e.jsx("div",{className:"box-shadow-employee-card bg-gray-50 !px-7 !py-8 rounded-[24px] inline-block",children:o?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_20px_1fr]  justify-between items-center",children:[e.jsxs("div",{className:"flex items-start flex-col",children:[e.jsxs("p",{className:"text-[#252B61] text-[22px] font-medium m-0",children:['Package "',o==null?void 0:o.service_name,'" Selected']}),e.jsxs("p",{className:"text-lg font-medium m-0 text-[22px]",children:[E," × ",f," Employees selected"]})]}),e.jsx("div",{className:"w-[1px] h-[99.4px] bg-[#000000] "}),e.jsxs("div",{className:"flex items-center gap-2 ",children:[e.jsx("p",{className:"text-gray-600 text-[22px] m-0",children:"Total cost"}),e.jsxs("p",{className:"text-4xl font-bold text-[#252B61] m-0",children:["₹",H.toFixed(2)]}),e.jsx("p",{className:"text-[#252B61] text-[22px] m-0 ",children:"Estimated"})]})]}):e.jsx("div",{children:e.jsx("p",{className:"text-[#252B61] text-[22px] m-0 ",children:"Please select a package to see the estimated cost."})})})})]}),e.jsx(ce,{open:$,handleClose:()=>F(!1),data:{title:`${t==null?void 0:t.name} Requested!`,message:"Our team will review the availability and logistics, and get back to you with the proposed dates and details shortly.",whatsNext:[e.jsxs("p",{children:[e.jsx("b",{children:"We’re reviewing"})," your request and checking availability."]}),e.jsxs("p",{children:[e.jsx("b",{children:"Our team will contact"})," you for any details needed."]}),e.jsxs("p",{children:[e.jsx("b",{children:"You’ll get a confirmation"})," once it’s scheduled."]})]},handleBack:()=>{m(`/package/${t==null?void 0:t.type}}`)}})]})};export{Oe as default};
